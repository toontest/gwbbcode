var GWConfig={css:{theme:"./public/gwbbcode/themes/arnapou/theme.css",skills:"./public/gwbbcode/skills/skills.css"},js:{data:{en:"./public/gwbbcode/data/en.js"},jQuery:"./public/gwbbcode/jquery.js"},db:{attributes:{axe:"18",ham:"19",swo:"20",tac:"21",str:"17",bea:"22",mar:"25",wil:"24",exp:"23",hea:"13",pro:"15",smi:"14",div:"16",blo:"4",cur:"7",dea:"5",sou:"6",dom:"2",ill:"1",ins:"3",fas:"0",air:"8",ear:"9",fir:"10",wat:"11",ene:"12",dag:"29",dead:"30",sha:"31",cri:"35",cha:"34",com:"32",res:"33",spa:"36",comma:"38",mot:"39",spe:"37",lea:"40",earthp:"43",scy:"41",win:"42",mys:"44",lux:"-1",kur:"-1",asu:"-1",del:"-1",ebo:"-1",lig:"-1",nor:"-1",sun:"-1"},long_attributes:{0:"Fast Casting",1:"Illusion Magic",2:"Domination Magic",3:"Inspiration Magic",4:"Blood Magic",5:"Death Magic",6:"Soul Reaping",7:"Curses",8:"Air Magic",9:"Earth Magic",10:"Fire Magic",11:"Water Magic",12:"Energy Storage",13:"Healing Prayers",14:"Divine Favor",15:"Protection Prayers",17:"Strength",18:"Axe Mastery",19:"Hammer Mastery",20:"Sword Mastery",21:"Tactics",22:"Beast Mastery",23:"Expertise",24:"Wilderness Survival",25:"Marksmanship",29:"Dagger Mastery",30:"Deadly Arts",31:"Shadow Arts",32:"Communing",33:"Restoration Magic",34:"Channeling Magic",35:"Critical Strikes",36:"Spawning Power",37:"Spear Mastery",38:"Command",39:"Motivation",40:"Leadership",41:"Scythe Mastery",42:"Wind Prayers",43:"Earth Prayers",44:"Mysticism",214:"Norn rank",215:"Vanguard rank",216:"Deldrimor rank",217:"Asura rank",238:"Sunspear rank",249:"Allegiance rank"},professions:{W:"1",R:"2",Mo:"3",N:"4",Me:"5",E:"6",A:"7",Rt:"8",P:"9",D:"10"},professionnames:{W:"Warrior",R:"Ranger",Mo:"Monk",N:"Necromancer",Me:"Mesmer",E:"Elementalist",A:"Assassin",Rt:"Ritualist",P:"Paragon",D:"Dervish"},professionkeys:{W:"W",R:"R",Mo:"Mo",N:"N",Me:"Me",E:"E",A:"A",Rt:"Rt",P:"P",D:"D"},campaigns:["Core","Prophecies","Factions","Nightfall","Eye of the North"],skills:{},search:{}},templates:{skill:'<span class="skill skillPack[pack] skill[id] [cls]"><span class="skill-[type]"></span><span class="skill-[elite]"></span></span>',detail:'<div class="gw-skill-detail gw-skill-[elite] gw-skill[prof]"><div class="gw-skill-panel">[skill][caracs]</div><div class="gw-skill-desc"><div class="gw-skill-name">[name]</div><div class="gw-skill-type">[type]</div><div class="gw-skill-text">[text]</div></div><div class="gw-skill-bottom"><div class="gw-skill-attr">[attr]</div><div class="gw-skill-chap">[chap]</div></div></div>',build:'<div class="gw-build gw-count[count]"><div class="gw-panel"><div class="gw-prof"><span class="gw-prof[prof1]" title="[profname1]"></span><span class="gw-prof[prof2]" title="[profname2]"></span></div></div><span class="gw-container"><span class="gw-skills"><span class="gw-skills-center">[skills]</span></span><span class="gw-attr">[attrs]</span><span class="gw-template">[template]</span></span></div>'},detail:{offset:{x:5,y:5}},forceFullBar:!0,lang:"en",loaded:!1};function GWBuild(){var e=this,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function s(e,t){for(;e.length<t;)e+="0";return e}function i(e,t){return s(a(parseInt(e).toString(2)),t)}function r(e){return parseInt(a(e),2)}function a(e){return(e||"").split("").reverse().join("")}function n(e){for(var s=t.length,i=0;i<s;i++)if(t.substr(i,1)==e)return i}function l(e){return 1==e.length?e=e.toUpperCase():e.length>1&&(e=(e[0]+"").toUpperCase()+e.substr(1).toLowerCase()),e}function o(e){return e=(e+"").toLowerCase()}this.setProfession1=function(t){t=l(t),GWConfig.db.professions[t]&&(e._professions[0]=parseInt(GWConfig.db.professions[t]))},this.setProfession2=function(t){t=l(t),GWConfig.db.professions[t]&&(e._professions[1]=parseInt(GWConfig.db.professions[t]))},this.findProfessionByInt=function(e){for(var t in GWConfig.db.professions)if("function"!=typeof GWConfig.db.professions[t]&&GWConfig.db.professions[t]==e)return t;return null},this.getProfession1=function(){return e.findProfessionByInt(e._professions[0])},this.getProfession2=function(){return e.findProfessionByInt(e._professions[1])},this.findAttributeByInt=function(e){var t,s=(t=GWConfig.db.long_attributes,new_obj={},rev_obj=Object.keys(t).reverse(),rev_obj.forEach(function(e){new_obj[e]=t[e]}),new_obj);return"function"!=typeof s[e]&&void 0!==s[e]?s[e]:null},this.getAttributevalue=function(t){t=o(t);var s=GWConfig.db.attributes[t];if(s)for(var i in e._attributes)if("function"!=typeof e._attributes[i]&&e._attributes[i]==s)return e._attributeValues[i];return 0},this.getAttributes=function(){for(var t={},s=e._attributes.length,i=0;i<s;i++)t[e.findAttributeByInt(e._attributes[i])]=e._attributeValues[i];return t},this.getSkills=function(){for(var t=[],s=e._skills.length,i=0;i<s;i++)t.push(e.getSkill(i));return t},this.getSkill=function(t){var s=new GWSkill,i=e._skills[t];return i>0&&s.setId(i),s.attrlevel=e.getAttributevalue(s.attr),s},this.addAttribute=function(t,s){if(t=o(t),(s+"").match(/\+/)){var i=s.split("+");s=0;for(var r=0;r<i.length;r++)s+=parseInt(i[r])}var a=GWConfig.db.attributes[t];if(!a)for(var n=6;n>=3;n--)for(var r in GWConfig.db.attributes)"string"==typeof r&&t.substr(0,n).toLowerCase()==r&&(a=GWConfig.db.attributes[r]);a&&(e._attributes.push(parseInt(a)),e._attributeValues.push(parseInt(s)))},this.setSkillName=function(t,s){var i=(s+"").replace(/[^a-z]/gi,"");GWConfig.db.search[i]&&(e._skills[t]=parseInt(GWConfig.db.search[i]))},this.clear=function(){e._professions=[0,0],e._attributes=[],e._attributeValues=[],e._skills=[0,0,0,0,0,0,0,0]},this.getTemplate=function(){var r=e._attributes.length,n="0111000000";n+=i(e._professions[0],4),n+=i(e._professions[1],4),n+=i(r,4),n+=i(2,4);for(var l=0;l<r;l++)n+=i(e._attributes[l],6),n+=i(e._attributeValues[l],4);var o=function(e){for(var t=0;0!=e;)e=Math.floor(e/2),t++;return 0==t?11:t}(function(e){for(var t=0,s=e.length,i=0;i<s;i++)e[i]>t&&(t=e[i]);return t}(e._skills));n+=i(o-8,4);for(l=0;l<8;l++)n+=i(e._skills[l],o);return function(e){var i=e.length%6,r="";for(0!=i&&(e=s(e,e.length+6-i));e.length>0;)r+=t.substr(parseInt(a(e.substr(0,6)),2),1),e=e.substr(6);return r}(n)},this.setTemplate=function(t){t=t.replace(/^\s*/g,"").replace(/\s*$/g,""),e.clear();var s=function(e){for(var t=e.length,s="",r=0;r<t;r++)s+=i(n(e.substr(r,1)),6);return s}(t);if("0111"==s.substr(0,4)&&(s=s.substr(4)),!(s.length<23)&&"000000"==s.substr(0,6)){s=s.substr(6),e._professions[0]=r(s.substr(0,4)),e._professions[1]=r(s.substr(4,4));var a=r(s.substr(8,4)),l=4+r(s.substr(12,4));s=s.substr(16);for(var o=0;o<a;o++)e._attributes.push(r(s.substr(0,l))),e._attributeValues.push(r(s.substr(l,4))),s=s.substr(4+l);if(!(s.length<4)){var c=8+r(s.substr(0,4));s=s.substr(4);for(o=0;o<8;o++){if(s.length<c)return;e._skills[o]=r(s.substr(0,c)),s=s.substr(c)}}}},this.getHtml=function(){var t=e.getSkills(),s="";for(var i in t)"function"!=typeof t[i]&&(GWConfig.forceFullBar||e._skills[i])&&(s+=t[i].getHtml());var r=e.getAttributes(),a="",n=0;for(var i in r)"function"!=typeof r[i]&&"null"!=i&&(n>0&&(a+=", "),a+=i+"-"+r[i],n++);var l=GWConfig.templates.build;return l=(l=(l=(l=(l=(l=(l=(l=l.replace("[count]",GWConfig.forceFullBar?8:e.skillsCount())).replace("[attrs]",a||"")).replace("[prof1]",GWConfig.db.professionkeys[e.getProfession1()]||"")).replace("[profname1]",GWConfig.db.professionnames[e.getProfession1()]||"")).replace("[prof2]",GWConfig.db.professionkeys[e.getProfession2()]||"")).replace("[profname2]",GWConfig.db.professionnames[e.getProfession2()]||"")).replace("[template]",e.getTemplate())).replace("[skills]",s)},this.skillsCount=function(){for(var t=0,s=0;s<e._skills.length;s++)e._skills[s]&&t++;return t},e.clear()}function GWSkill(){var e=this;this.attrlevel=null,this.cls=null,this.id=null,this.profession=null,this.elite=null,this.name=null,this.description=null,this.type=null,this.ty=null,this.chapter=null,this.attribute=null,this.attr=null,this.caracs=null,this.setId=function(t){var s=GWConfig.db.skills[t];if(s){var i=[];s.z&&(s.z.s&&(i.sacrifice=s.z.s),s.z.x&&(i.exhaustion=s.z.x),s.z.d&&(i.eregen="-"+s.z.d),s.z.g&&(i.eregen=s.z.d),s.z.e&&(i.energy=s.z.e),s.z.a&&(i.adrenaline=Math.ceil(s.z.a/25)),s.z.c&&(i.casting=s.z.c),s.z.r&&(i.recharge=s.z.r)),e.id=t,e.profession=s.p,e.elite=1==s.e,e.name=s.n,e.description=s.d,e.type=s.t,e.ty=s.y,e.chapter=s.c,e.attribute=s.a,e.attr=s.b,e.caracs=i}},this.setName=function(t){var s=(t+"").replace(/[^a-z]/gi,"");GWConfig.db.search[s]&&e.setId(parseInt(GWConfig.db.search[s]))},this.getHtml=function(){var t=GWConfig.templates.skill;return t=(t=(t=(t=(t=t.replace("[pack]",e.id?Math.floor(e.id/100):"0")).replace("[id]",e.id||"empty")).replace("[cls]",e.cls||"")).replace("[type]",e.ty)).replace("[elite]",e.elite?"elite":"noelite")},this.getSkillType=function(e){return desc=GWConfig.db.skills[e].d,skill_type=desc.match(/^([a-z]+[ a-z]*)\. /i)[1],skill_type},this.getCampaign=function(e){return GWConfig.db.campaigns[e]},this.getLongAttrById=function(e){return GWConfig.db.long_attributes[e]},this.getDescription=function(){var t,s=e.description;if(s=s.replace(/([0-9]+\.\.\.?[0-9]+(?:\.\.\.?[0-9]+)?)/gi,"<b>$1</b>"),e.attrlevel)for(;t=s.match(/([0-9]+)\.\.\.?([0-9]+)(?:\.\.\.?[0-9]+)?/i);){var i=parseInt(t[1]),r=parseInt(t[2]),a=Math.floor((r-i)/15*e.attrlevel+i);s=s.replace(t[0],a)}return s},this.getCaracs=function(){var t="";for(var s in e.caracs)"function"!=typeof e.caracs[s]&&(t+='<li class="gw-carac-'+s+'"><span></span>'+e.caracs[s]+"</li>");return"<ul>"+t+"</ul>"},this.getHtmlDetail=function(){skill_type=this.getSkillType(e.id),chapter=this.getCampaign(e.chapter),long_attr=this.getLongAttrById(e.attribute);var t=GWConfig.templates.detail;return t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace("[prof]",e.profession)).replace("[elite]",e.elite?"elite":"noelite")).replace("[name]",e.name)).replace("[type]",skill_type)).replace("[attr]",(long_attr||"")+(e.attrlevel?" <b>"+e.attrlevel+"</b>":""))).replace("[chap]",chapter)).replace("[text]",e.getDescription())).replace("[caracs]",e.getCaracs())).replace("[skill]",e.getHtml())}}function GWBindEvents(e){"string"==typeof e&&(e=jQuery(e)),e.find(".skill, .skill-text").each(function(){var e,t=jQuery(this).get(0).className;if(e=t.match(/skill([0-9]+)/i))GWBindSkill(this,e[1]);else if(e=t.match(/skill-text([0-9]+)/i)){GWBindSkill(this,e[1])}})}function GWOnLoad(e){if(!GWConfig.loaded){GWConfig.loaded=!0;var t=function(e){var t=document.getElementsByTagName("head")[0]||document.documentElement,s=document.createElement("link");s.type="text/css",s.rel="stylesheet",s.href=e,s.media="screen",t.appendChild(s)},s=function(){jQuery(function(){t(GWConfig.css.theme),t(GWConfig.css.skills),jQuery.ajax({cache:!0,url:GWConfig.js.data[GWConfig.lang],dataType:"script",success:function(){e&&e()}})})};"undefined"==typeof jQuery?function(e,t){var s=document.getElementsByTagName("head")[0]||document.documentElement,i=document.createElement("script");if(i.type="text/javascript",i.src=e,t){var r=!1;i.onload=i.onreadystatechange=function(){r||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(r=!0,t(),i.onload=i.onreadystatechange=null,s&&i.parentNode&&s.removeChild(i))}}s.appendChild(i)}(GWConfig.js.jQuery,function(){jQuery.noConflict(),s()}):s()}}function GWBBCodeParse(e){"string"==typeof e&&(e=jQuery(e)),e.each(function(){for(var t,s,i,r,a,n,l,o,c,u,f,p,g,d,h,b=jQuery(this).html(),m=b,v=[];s=m.match(/\[nobb\].*?\[\/nobb\]/i);)m=m.replace(s[0],"#NO-BB-"+v.length+"#"),v.push(s[0]);for(;s=m.match(/\[build\s*=\s*([^\]]+)\]\[\/build\]/i);)(n=new GWBuild).setTemplate(s[1]),m=m.replace(s[0],n.getHtml());for(;s=m.match(/\[build\s*=\s*([^\]]+)\]/i);)(n=new GWBuild).setTemplate(s[1]),m=m.replace(s[0],n.getHtml());for(;s=m.match(/\[build([^\[]+)](.*?)\[\/build]/i);){for(g=s[0],n=new GWBuild,d=s[1],h=GWSanitizeString(s[2].replace(/\[/g,"").replace(/\]$/,""));s=d.match(/([a-z]+)=([a-z0-9+\/]+)/i);)i=s[0],r=s[1],a=s[2],r.match(/prof/i)?(s=a.match(/^([a-z]+)\/([a-z\?]*)$/i))?(n.setProfession1(s[1]),n.setProfession2(s[2])):(s=a.match(/^([a-z]+)$/i))&&n.setProfession1(s[1]):a.match(/^[0-9\+]+$/)&&n.addAttribute(r,a),d=d.replace(i,"");for(t in f=h.split("]"))"function"!=typeof f[t]&&((s=f[t].match(/^(.*)\@([0-9]+)$/))?n.setSkillName(t,s[1]):n.setSkillName(t,f[t]));m=m.replace(g,n.getHtml())}for(;s=m.match(/\[\[(.*?)\]/i);)g=s[0],p=s[1],l="",o="",(s=s[1].match(/^(.*)\@([0-9]+)$/))&&(p=s[1],o=s[2]),p=GWSanitizeString(p).replace(/[^a-z]+/g,""),GWConfig.db.search[p]?(c=GWConfig.db.search[p],o&&(l="gw-attr-"+GWConfig.db.skills[c].b+"-"+o),m=m.replace(g,'<a href="javascript:void(0)" class="skill-text skill-text'+c+" "+l+'">'+GWConfig.db.skills[c].n+"</a>")):(m=m.replace(g,"#NO-BB-"+v.length+"#"),v.push(g));for(;s=m.match(/\[(.*?)\]/i);)g=s[0],p=s[1],l="",o="",(s=s[1].match(/^(.*)\@([0-9]+)$/))&&(p=s[1],o=s[2]),p=GWSanitizeString(p).replace(/[^a-z]+/g,""),GWConfig.db.search[p]?(c=GWConfig.db.search[p],o&&(l="gw-attr-"+GWConfig.db.skills[c].b+"-"+o),(u=new GWSkill).setId(c),u.cls=l,m=m.replace(g,u.getHtml())):(m=m.replace(g,"#NO-BB-"+v.length+"#"),v.push(g));for(t=0;t<v.length;t++)m=m.replace("#NO-BB-"+t+"#",v[t]);m!=b&&(jQuery(this).html(m),GWBindEvents(e))})}function GWBindSkill(e,t){var s,i="#skillDiv"+t,r=jQuery(e).parents(".gw-build"),a=new GWSkill;(a.setId(t),1==r.length)&&((s=r.get(0).className.match(new RegExp("gw-attr-"+a.attr+"-([0-9]+)","i")))&&(a.attrlevel=s[1],i+=a.attr+s[1]));(s=e.className.match(new RegExp("gw-attr-"+a.attr+"-([0-9]+)","i")))&&(a.attrlevel=s[1],i+=a.attr+s[1]);var n=jQuery.find(i);0==n.length&&(n=jQuery(a.getHtmlDetail()),jQuery("body").append(n)),jQuery(e).hover(function(){n.show()},function(){n.hide()}).mousemove(function(e){n.css({left:e.pageX+GWConfig.detail.offset.x+"px",top:e.pageY+GWConfig.detail.offset.y+"px"})})}function GWSanitizeString(e){var t=e.toLowerCase();return t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/\s/g,"")).replace(/[àáâãäå]/g,"a")).replace(/æ/g,"ae")).replace(/ç/g,"c")).replace(/[èéêë]/g,"e")).replace(/[ìíîï]/g,"i")).replace(/ñ/g,"n")).replace(/[òóôõö]/g,"o")).replace(/œ/g,"oe")).replace(/[ùúûü]/g,"u")).replace(/[ýÿ]/g,"y")).replace(/[\s\r\n\t]/g,"")}